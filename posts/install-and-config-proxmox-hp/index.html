<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="en_uk"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Install and config Proxmox 7.2 on a HP server" /><meta property="og:locale" content="en" /><meta name="description" content="Install and config Proxmox 7.2 on a HP server" /><meta property="og:description" content="Install and config Proxmox 7.2 on a HP server" /><link rel="canonical" href="https://rgcosta7.github.io/posts/install-and-config-proxmox-hp/" /><meta property="og:url" content="https://rgcosta7.github.io/posts/install-and-config-proxmox-hp/" /><meta property="og:site_name" content="h0melab.uk" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-10T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Install and config Proxmox 7.2 on a HP server" /><meta name="twitter:site" content="@rgcosta7" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-24T10:38:29+01:00","datePublished":"2022-06-10T00:00:00+01:00","description":"Install and config Proxmox 7.2 on a HP server","headline":"Install and config Proxmox 7.2 on a HP server","mainEntityOfPage":{"@type":"WebPage","@id":"https://rgcosta7.github.io/posts/install-and-config-proxmox-hp/"},"url":"https://rgcosta7.github.io/posts/install-and-config-proxmox-hp/"}</script><title>Install and config Proxmox 7.2 on a HP server | h0melab.uk</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="h0melab.uk"><meta name="application-name" content="h0melab.uk"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">h0melab.uk</a></div><div class="site-subtitle font-italic">docs.h0melab.uk</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/rgcosta7" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/rgcosta7" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['admin','h0melab.uk'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Install and config Proxmox 7.2 on a HP server</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Install and config Proxmox 7.2 on a HP server</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1654815600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 10, 2022 </em> </span> <span> Updated <em class="" data-ts="1656063509" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 24, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/rgcosta7">Raul Costa _pt</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="755 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h1 id="install-and-config-proxmox-72-on-a-hp-server">Install and config Proxmox 7.2 on a HP server</h1><h2 id="download-the-iso"><span class="mr-2">Download the ISO</span><a href="#download-the-iso" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You can find on the official website, <a href="https://www.proxmox.com/en/downloads/category/iso-images-pve">Download ISO</a></p><h2 id="install-proxmox"><span class="mr-2">Install Proxmox</span><a href="#install-proxmox" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Easy installation, make sure you select the right hard-drive and put the right configuration for your network. later you can configure <b>VLANS</b></p><p>When finish install, the machine will reboot and will be ready. You’ll see the URL on the screen:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://192.168.70.180:8006
</pre></table></code></div></div><h2 id="configurations"><span class="mr-2">Configurations</span><a href="#configurations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Most of this configuration can be done on Proxmox GUI but here I’ll use the CLI.</p><h3 id="repositories"><span class="mr-2">Repositories:</span><a href="#repositories" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Add no subscription proxmox repo:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /etc/apt/sources.list
</pre></table></code></div></div><p>Add to the end:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>deb http://download.proxmox.com/debian/pve bullseye pve-no-subscription
</pre></table></code></div></div><p>You can remove/comment the enterprise repo,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /etc/apt/sources.list.d/pve-enterprise.list
</pre></table></code></div></div><p>Make sure you have all updated packages:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>apt update <span class="o">&amp;&amp;</span> apt upgrade <span class="nt">-y</span> <span class="o">&amp;&amp;</span> apt dist-upgrade <span class="nt">-y</span>
</pre></table></code></div></div><h3 id="patch-kernel-and-modules-for-pci-passthrough--hp-servers"><span class="mr-2">Patch Kernel and modules for PCI passthrough (HP SERVERS):</span><a href="#patch-kernel-and-modules-for-pci-passthrough--hp-servers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In my case I use a DL380 G9 and couldn’t pass my 4 NIC PCI to the pfsense, I need to change the kernel to alow it. I found this GitHub page from <a href="https://github.com/MichaelTrip/relax-intel-rmrr">MichaelTrip</a>, a big thanks to him!!</p><h4 id="1---download-the-patched-kernel"><span class="mr-2">1 - Download the patched kernel</span><a href="#1---download-the-patched-kernel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>At the shell:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">mkdir </span>iommu <span class="o">&amp;&amp;</span> <span class="nb">cd </span>iommu
</pre></table></code></div></div><p>and download the patched kernel:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>wget https://github.com/MichaelTrip/relax-intel-rmrr/releases/download/v1.0.8/linux-tools-5.13-dbgsym_5.13.19-4_amd64.deb
wget https://github.com/MichaelTrip/relax-intel-rmrr/releases/download/v1.0.8/linux-tools-5.13_5.13.19-4_amd64.deb
wget https://github.com/MichaelTrip/relax-intel-rmrr/releases/download/v1.0.8/pve-headers-5.13.19-2-pve-relaxablermrr_5.13.19-4_amd64.deb
wget https://github.com/MichaelTrip/relax-intel-rmrr/releases/download/v1.0.8/pve-kernel-5.13.19-2-pve-relaxablermrr_5.13.19-4_amd64.deb
wget https://github.com/MichaelTrip/relax-intel-rmrr/releases/download/v1.0.8/pve-kernel-libc-dev_5.13.19-4_amd64.deb
</pre></table></code></div></div><p>Install the kernek,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dpkg <span class="nt">-i</span> <span class="k">*</span>.deb
</pre></table></code></div></div><h4 id="2---set-the-kernel-as-default"><span class="mr-2">2 - Set the kernel as default</span><a href="#2---set-the-kernel-as-default" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Find the new kernel IDs,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">grep </span>menu /boot/grub/grub.cfg
</pre></table></code></div></div><p>From the previus output you will need to find the submenu option ID, something like this <code class="language-plaintext highlighter-rouge">gnulinux-advanced-83ea5c69-120d-4ba6-8d91-e3de2dc98b0a</code> and the relaxablermrr <code class="language-plaintext highlighter-rouge">gnulinux-5.13.19-2-pve-relaxablermrr-advanced-83ea5c69-120d-4ba6-8d91-e3de2dc98b0a</code></p><p>Copy both from your output, you’ll need it to set them as a default kernel in each boot.</p><p>Edit grub,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /etc/default/grub
</pre></table></code></div></div><p>On the <code class="language-plaintext highlighter-rouge">GRUB_DEFAULT</code> you need to paste the IDs that you copy early in this format:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">GRUB_DEFAULT</span><span class="o">=</span><span class="s2">"SUBMENU_ID&gt;MENUENTRY_ID"</span>
</pre></table></code></div></div><p>You’ll need to add <code class="language-plaintext highlighter-rouge">intel_iommu=on,relax_rmrr iommu=pt</code> to the line <code class="language-plaintext highlighter-rouge">GRUB_CMDLINE_LINUX_DEFAULT="quiet"</code> to look like this,</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GRUB_CMDLINE_LINUX_DEFAULT="quiet intel_iommu=on,relax_rmrr iommu=pt"
</pre></table></code></div></div><h4 id="3---load-the-neccessary-modules"><span class="mr-2">3 - Load the neccessary modules</span><a href="#3---load-the-neccessary-modules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Edit <code class="language-plaintext highlighter-rouge">/etc/modules</code> and add to the end:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>vfio
vfio_iommu_type1
vfio_pci
vfio_virqfd
</pre></table></code></div></div><p>And to finish, one last option need to be add:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"options vfio_iommu_type1 allow_unsafe_interrupts=1"</span> <span class="o">&gt;</span> /etc/modprobe.d/iommu_unsafe_interrupts.conf
</pre></table></code></div></div><p>Now you can reboot, finger crossed that all was done right,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>shutdown <span class="nt">-r</span> now
</pre></table></code></div></div><p>After boot you can confir wich kernel you using by typing,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">uname</span> <span class="nt">-r</span>
</pre></table></code></div></div><p>You should get <code class="language-plaintext highlighter-rouge">5.13.19-2-pve-relaxablermrr</code> at the time I was writing this page. And you can check if IOMMU was loaded,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dmesg | <span class="nb">grep</span> <span class="s1">'Intel-IOMMU'</span>
</pre></table></code></div></div><h3 id="expand-local-volume-merge-all-the-volumes"><span class="mr-2">Expand local volume (merge all the volumes)</span><a href="#expand-local-volume-merge-all-the-volumes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On the proxmox webgui go to <code class="language-plaintext highlighter-rouge">Datacenter --&gt; Storage</code> select local-lvm and remove it!</p><p>Go to proxmox shell and,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>lvremove /dev/pve/data
lvresize <span class="nt">-l</span> +100%FREE /dev/pve/root
resize2fs /dev/mapper/pve-root  
</pre></table></code></div></div><p>This should it, you can see that now you just have local and all the free space is in local.</p><p>Again, go to <code class="language-plaintext highlighter-rouge">Datacenter --&gt; Storage</code> and edit local to be use for all the purpose, ‘Disk image’, ‘ISO image’…all of them in my case!</p><h3 id="container-templates"><span class="mr-2">Container Templates</span><a href="#container-templates" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If is missing some templates from the list, special the TurnKey you’ll need to run the follow command on the shell:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pveam update
</pre></table></code></div></div><h3 id="network"><span class="mr-2">Network</span><a href="#network" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>NIC TEAM (LACP)</strong></p><p>To enable port bound on a network just edit interfaces file and add the follow lines:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /etc/network/interfaces
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>auto bond0
iface bond0 inet manual
    	bond-slaves enp3s0f0 enp3s0f1
        bond-miimon 100
        bond-mode 802.3ad
        bond-xmit-hash-policy layer2+3
</pre></table></code></div></div><p>NOTE: bond-slaves are the name of the both ports you want to bond, you’ll need to look for the names that your system are using.</p><p><strong>VLANS</strong></p><p>You can make a interfaces vlan aware just by adding the last 2 lines of code to the interfaces file:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /etc/network/interfaces
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>auto vmbr0
iface vmbr0 inet static
    	address 172.31.12.99/24
        gateway 172.31.12.254
        bridge-ports bond0
        bridge-stp off
        bridge-fd 0
        bridge-vlan-aware yes
        bridge-vids 2-4094
</pre></table></code></div></div><p>For a more complex VLAN setup you can create a Linux VLAN and then create a Linux Brigde to that VLAN. When create a VM or a container you can pick what bridge you want to give to the VM/Container.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /etc/network/interfaces
</pre></table></code></div></div><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>auto enp3s0f2.50
iface enp3s0f2.50 inet manual
#This is VLAN 50 for ADMIN


auto vmbr0
iface vmbr0 inet static
    address 172.31.50.99/24
    gateway 172.31.50.190
    bridge-ports enp3s0f2.50
    bridge-stp off
    bridge-fd 0
#This is VLAN 50 for ADMIN
</pre></table></code></div></div><p>This way you don’t need to tell the Bridge about the VLANS</p><p><b>PS:</b> MAKE SURE YOUR SWITCH ARE PROPERLY SETUP FOR VLANS</p><p>Restart the network</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>systemctl restart networking.service
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/proxmox/'>proxmox</a>, <a href='/categories/server/'>server</a>, <a href='/categories/hardware/'>hardware</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/server/" class="post-tag no-text-decoration" >server</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/lxc/" class="post-tag no-text-decoration" >lxc</a> <a href="/tags/container/" class="post-tag no-text-decoration" >container</a> <a href="/tags/debian/" class="post-tag no-text-decoration" >debian</a> <a href="/tags/proxmox/" class="post-tag no-text-decoration" >proxmox</a> <a href="/tags/hp/" class="post-tag no-text-decoration" >hp</a> <a href="/tags/hardware/" class="post-tag no-text-decoration" >hardware</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Install+and+config+Proxmox+7.2+on+a+HP+server+-+h0melab.uk&url=https%3A%2F%2Frgcosta7.github.io%2Fposts%2Finstall-and-config-proxmox-hp%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Install+and+config+Proxmox+7.2+on+a+HP+server+-+h0melab.uk&u=https%3A%2F%2Frgcosta7.github.io%2Fposts%2Finstall-and-config-proxmox-hp%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Frgcosta7.github.io%2Fposts%2Finstall-and-config-proxmox-hp%2F&text=Install+and+config+Proxmox+7.2+on+a+HP+server+-+h0melab.uk" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/blog-week10/">Outcome 3 - Implement security measures to protect corporate data - Week 10</a><li><a href="/posts/blog-week9/">Outcome 3 - Physical Security - Week 9</a><li><a href="/posts/blog-week8/">Outcome 3 - Damage Mitigation and Whitelisting v Blacklisting - Week 8</a><li><a href="/posts/blog-week7/">Outcome 3 - Backup Strategies - Week 7</a><li><a href="/posts/blog-week6/">Outcome 3 - Implement security measures to protect corporate data - Week 6</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/data-security/">data security</a> <a class="post-tag" href="/tags/debian/">debian</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/server/">server</a> <a class="post-tag" href="/tags/breach/">breach</a> <a class="post-tag" href="/tags/data/">data</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/backup/">backup</a> <a class="post-tag" href="/tags/backups/">backups</a> <a class="post-tag" href="/tags/data-recovery/">data recovery</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/install-pihole-lxc/"><div class="card-body"> <em class="small" data-ts="1655420400" data-df="ll" > Jun 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Install Pi-Hole DNS filter</h3><div class="text-muted small"><p> Install Pi-Hole in a Proxmox container (LXC Template) Download the Debian template To start you will need to have the CT template on proxmox, go to your proxmox node, select the storage (in my ca...</p></div></div></a></div><div class="card"> <a href="/posts/create-and-format-linux/"><div class="card-body"> <em class="small" data-ts="1655420400" data-df="ll" > Jun 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to create, format and mount partition on linux</h3><div class="text-muted small"><p> How to create, format and mount partition on linux</p></div></div></a></div><div class="card"> <a href="/posts/install-docker-vm/"><div class="card-body"> <em class="small" data-ts="1655420400" data-df="ll" > Jun 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Install Docker in a proxmox VM!</h3><div class="text-muted small"><p> Install Docker in Debian 11 VM Install Debian How-to? WIP Install Docker and docker-compose Always update the system: 1 sudo apt update &amp;amp;&amp;amp; sudo apt upgrade Install needed packages. 1 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"><div class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></div><a href="/posts/install-pihole-lxc/" class="btn btn-outline-primary" prompt="Newer"><p>Install Pi-Hole DNS filter</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/rgcosta7">Raul Costa _pt</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/data-security/">data security</a> <a class="post-tag" href="/tags/debian/">debian</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/server/">server</a> <a class="post-tag" href="/tags/breach/">breach</a> <a class="post-tag" href="/tags/data/">data</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/backup/">backup</a> <a class="post-tag" href="/tags/backups/">backups</a> <a class="post-tag" href="/tags/data-recovery/">data recovery</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en_uk.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
